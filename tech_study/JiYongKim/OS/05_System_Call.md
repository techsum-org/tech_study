# 주제 : System Call

## 목차
- 주제 : System Call
  - [System Call이란?](#system-call이란)
  - [System Call이 필요한 이유](#system-call이-필요한-이유)
  - [유저모드와 커널모드란?](#유저모드와-커널모드란)
  - [유저모드와 커널모드의 전환](#유저모드와-커널모드의-전환)
  - [System Call의 종류](#system-call의-종류)
  - [System Call 정리](#system-call-정리)

<br>

---

## System Call이란?
<img width="675" alt="스크린샷 2023-05-26 오전 5 10 26" src="https://github.com/techsum-org/tech_study/assets/81874493/8fadbb2d-a9f6-4697-82ff-4ba736fe0353">

* 정의 : 시스템 호출은 운영체제의 커널이 제공하는 서비스에 대하여 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스 이다.

<br>

>사용자 프로그램이 디스크 파일을 접근하거나 화면에 결과를 출력하는 등 컴퓨터 자원이 필요한 작업이 필요한 경우,

>사용자 프로그램이 특권 명령의 수행을 필요로 하는 경우, <U>운영체제에게 특권 명령의 대행을 요청하는 것</U>이 시스템 콜이다.





<br>

---


## System Call이 필요한 이유

**System Call은 왜 필요할까?**
    
- 유저레벨의 프로그램은 유저레벨의 함수들 만으로는 많은 기능을 구현하기 힘들기 때문에, 커널(kernel)의 도움을 반드시 받아야 한다.
    
    <br>

    >이러한 작업은 응용프로그램으로 대표되는 유저 프로세스(User Process)에서 유저모드에서는 수행할 수 없다.
    
    >반드시 <U>**kernel에 관련된 것은 커널모드로 전환한 후**</U>에야, 해당 작업을 수행할 권한이 생기며 커널 모드를 통해 이러한 작업은 반드시 시스템 콜을 통해 수행하도록 설계되어 있다.

<br>

**<그렇다면 유저 모드와 커널모드와 같은 권한은 왜 필요한 것일까?>**

만약 권한이 없을 때, <U>해커가 피해를 입히기 위해 악의적으로 시스템 콜을 사용하는 경우</U>나 <U>초보 사용자가 하드웨어 명령어를 잘 몰라서 아무렇게 함수를 호출했을 경우</U>에 

><U>**시스템 전체를 망가뜨릴 수도 있기 때문이다.**</U> 

<br>

따라서 이러한 명령어들은 특별하게 커널 모드에서만 실행할 수 있도록 설계되었고,

만약 <U>유저 모드에서 시스템 콜을 호출할 경우에는 운영체제에서 불법적인 접근이라 여기고 trap을 발생시킨다.</U>

<br>

---

## 유저모드와 커널모드란?

<br>

- OS의 동작
        
    OS는 커널모드와 사용자 모드로 나뉘어 구동된다.
        
    >⇒ 응용프로그램이 운영체제의 커널영역을 건드리지 못하게 하여 시스템을 보호하기 위해 나뉘어 구동된다.
        
    <br>

    - 커널 모드 : 컴퓨터 자원에 대하여 접근, 명령할 수 있는 모드
      - 모든 자원(드라이버, 메모리, CPU 등)에 접근, 명령을 할 수 있다.  
        ⇒ 커널모드 = 유저 모드의 사용  +  커널 사용 모두 사용가능 
    
    <br>

    - 유저 모드 : 접근할 수 있는 영역을 제한하여, 컴퓨터 자원을 함부로 침범하지 못하게 하는 모드
      - 유저(사용자)가 접근할 수 있는 영역을 제한적으로 두고, 프로그램의 자원에 함부로 침범하지 못하는 모드 이다.
      - 사용자는 여기서 코드를 작성하고, 프로세스를 실행하는 등의 행동을 할 수 있다.
      - 유저 어플리케이션 코드가 유저모드에서 실행된다. 
      - 유저 모드 → 커널 모드 전환 또한 인터럽트를 통해 가능하다.

<br>

---

##  유저모드와 커널모드의 전환


<img width="865" alt="스크린샷 2023-05-26 오전 5 34 48" src="https://github.com/techsum-org/tech_study/assets/81874493/e57ce6d4-3644-445d-971f-8aee3dea5a48">

프로세스가 실행되는 동안에 프로세스는 수없이 유저모드와 커널모드를 전환 하면서 실행이 된다.

* (유저모드 -> 커널모드 요청)
  * 프로세스가 유저모드에서 실행되다가 특별한 요청이 필요할때 system call을 이용해서 커널에 요청을 한다. 

* (커널모드 -> 유저모드로 반환)
  * system call의 요청을 받은 커널이 그 요청에 대한 일을 하고 결과값을 system call의 리턴 값으로 전해준다.

<br>

예시)


<img width="665" alt="스크린샷 2023-05-26 오전 6 34 40" src="https://github.com/techsum-org/tech_study/assets/81874493/096d809a-1216-4b72-aede-6b6229f05311">

예를 들어 프로세스가 실행되고있는 중에 라이브러리 함수나 유저 어플리케이션에서 I/O 요청이 왔을 경우 

1. System Call을 통해 유저모드 -> 커널모드 전환
2. 커널의 I/O 관리자가 요청에 맞는 장치드라이버에게 요청
3. 장치 드라이버는 자신과 호환되는 디바이스에게 작업 명령
4. 작업 처리후 장치 드라이버는 return 값을 커널에게 다시 return
5. 커널은 작업 완료 return값을 User Application으로 return
6. 유저모드 전환

<br>

---
## System Call의 종류


* 프로세스 컨트롤
  * 프로세스 생성 및 종료
  * 메모리에 로드, 실행
  * 프로세스 속성 값 확인, 지정
  * wait 이벤트, signal 이벤트
  * 메모리 할당

<br>


* 파일 메니지먼트
  * 파일 생성, 파일 삭제
  * 열기, 닫기
  * 읽기, 쓰기, Reposition
  * 파일 속성 값 확인, 지정

<br>


* 디바이스 매니지먼트
  * 디바이스 요청 및 해제
  * 읽기, 쓰기, Reposition
  * 디바이스 속성 확인, 지정
  * 비 물리적인 디바이스 해제 및 장착

<br>


* 정보 관리
  * 시간 확인, 시간 지정
  * 시스템 데이터 확인, 지정
  * 프로세스, 파일, 디바이스 속성 가져오기
  * 프로세스, 파일, 디바이스 속성 설정하기

<br>


* 커뮤니케이션
  * 커뮤니케이션 연결 생성 및 삭제
  * 메시지 송신, 수신
  * 상태 정보 전달
  * remote 디바이스 해제 및 장착

<br>


* 보안
  * Permission 획득
  * Permission 설정

<br>

---
## System Call 정리


* System Call이란 무엇인가요?
  * 답변 : 시스템 호출은 운영체제의 커널이 제공하는 서비스에 대하여 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스 입니다.

<br>

* System Call은 왜 필요한가요?
  * 답변 : 저레벨의 프로그램은 유저레벨의 함수들 만으로는 많은 기능을 구현하기 힘들기 때문에, 커널(kernel)의 도움을 반드시 받아야 합니다 커널의 도움을 받기 위해서는 커널모드로 변환 해야 하며 이는 시스템 콜을 통해서만 가능하도록 설계되어 있기 때문에 System Call이 필요하다고 할 수 있습니다.
    

<br>

* 커널모드와 유저모드가 무엇인가요?
  * 답변 : 커널 모드란 컴퓨터 자원에 대하여 접근, 명령할 수 있는 모드 이며 모든 자원(드라이버, 메모리, CPU 등)에 접근, 명령을 할 수 있습니다.
    
    
    유저 모드란 접근할 수 있는 영역을 제한하여 컴퓨터 자원을 함부러 침범하지 못하도록 하는 모드 입니다.
    <br>


<br>

* 유저 모드와 커널모드와 같은 권한은 왜 필요 한가요?
  * 답변 : 만약 권한이 없을 때, 해커가 피해를 입히기 위해 악의적으로 시스템 콜을 사용하는 경우 혹은 초보 사용자가 하드웨어 명령어를 잘 몰라서 아무렇게 함수를 호출했을 경우에 시스템 전체를 망가뜨릴 수도 있기 때문입니다.

<br>


<br>
